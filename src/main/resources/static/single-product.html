<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>小苏商城</title>
    <!-- Favicons -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">
    <link rel="stylesheet" href="assets/css/vendor/vendor.min.css">
    <link rel="stylesheet" href="assets/css/plugins/plugins.min.css">
    <link rel="stylesheet" href="assets/css/style.min.css">
</head>
<body>
<!-- Header Section Start -->
<div class="header section">
    <!-- Header Bottom Start -->
    <div class="header-bottom">
        <div class="header-sticky">
            <div class="container">
                <div class="row align-items-center position-relative">

                    <!-- Header Logo Start -->
                    <div class="col-lg-3 col-md-4 col-6">
                        <div class="header-logo">
                            <a href="index.html"><img src="assets/images/logo/logo.png" alt="Site Logo" /></a>
                        </div>
                    </div>
                    <!-- Header Logo End -->

                    <!-- Header Menu Start -->
                    <div class="col-lg-6 d-none d-lg-block">
                        <div class="main-menu">
                            <ul>
                                <li class="has-children position-static">
                                    <a href="shop.html">商品列表</a>
                                </li>
                                <li><a href="checkout.html">添加收货地址</a></li>
                                <li><a href="cart.html">购物车</a></li>
                            </ul>
                        </div>
                    </div>
                    <!-- Header Menu End -->

                    <!-- Header Action Start -->
                    <div class="col-lg-3 col-md-8 col-6">
                        <div class="header-actions">
                            <!-- Header My Account Button Start -->
                            <a href="my-account.html" class="header-action-btn header-action-btn-wishlist">
                                <i class="icon-user icons"></i>
                            </a>
                            <!-- Header My Account Button End -->

                            <!-- Mobile Menu Hambarger Action Button Start -->
                            <a href="javascript:void(0)" class="header-action-btn header-action-btn-menu d-lg-none d-md-flex">
                                <i class="icon-menu"></i>
                            </a>
                            <!-- Mobile Menu Hambarger Action Button End -->

                        </div>
                    </div>
                    <!-- Header Action End -->

                </div>
            </div>
        </div>
    </div>
    <!-- Header Bottom End -->

</div>
<!-- Header Section End -->

<!-- Breadcrumb Area Start -->
<div class="section breadcrumb-area bg-name-bright">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center">
                <div class="breadcrumb-wrapper">
                    <h2 class="breadcrumb-title">商品详情</h2>
                    <ul>
                        <li><a href="index.html">主页</a></li>
                        <li>商品详情</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Breadcrumb Area End -->

<!-- Single Product Section Start -->
<div class="section section-margin">
    <div class="container">
        <div class="row">

            <div class="col-lg-5 offset-lg-0 col-md-8 offset-md-2">

                <!-- Product Details Image Start -->
                <div class="product-details-img">

                    <!-- Single Product Image Start -->
                    <div class="single-product-img swiper-container product-gallery-top">
                        <div class="swiper-wrapper popup-gallery" id="top-image">
                            <div class="swiper-slide w-100">
                                <img id="detail-image" class="w-100" src="assets/images/products/large-product/1.webp" alt="Product">
                            </div>
                        </div>
                        <!-- Next Previous Button Start -->
                        <div id="right-image" class="swiper-button-next swiper-nav-button"><i class="ti-arrow-right"></i></div>
                        <div id="left-image" class="swiper-button-prev swiper-nav-button"><i class="ti-arrow-left"></i></div>
                        <!-- Next Previous Button End -->
                    </div>
                    <!-- Single Product Image End -->


                    <!--详情图片 开始-->
<!--                    <div class="single-product-thumb swiper-container product-gallery-thumbs" >-->
<!--                        <div class="swiper-wrapper" >-->
<!--                            <div class="swiper-slide">-->
<!--                                <img src="assets/images/products/medium-plus-product/1.webp" alt="Product">-->
<!--                            </div>-->
<!--                            <div class="swiper-slide" >-->
<!--                                <img src="assets/images/products/medium-plus-product/2.webp" alt="Product">-->
<!--                            </div>-->
<!--                            <div class="swiper-slide">-->
<!--                                <img src="assets/images/products/medium-plus-product/3.webp" alt="Product">-->
<!--                            </div>-->
<!--                        </div>-->
<!--&lt;!&ndash;                        &lt;!&ndash; Next Previous Button Start &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                        <div class="swiper-button-next swiper-nav-button"><i class="ti-arrow-right"></i></div>&ndash;&gt;-->
<!--&lt;!&ndash;                        <div class="swiper-button-prev swiper-nav-button"><i class="ti-arrow-left"></i></div>&ndash;&gt;-->
<!--&lt;!&ndash;                        &lt;!&ndash; Next Previous Button End &ndash;&gt;&ndash;&gt;-->
<!--                    </div>-->
                    <!--图片详情结束--->

                </div>
                <!-- Product Details Image End -->

            </div>

            <div class="col-lg-7">

                <!-- Product Summery Start -->
                <div class="product-summery position-relative">

                    <!-- Product Head Start -->
                    <div class="product-head m-b-15" id="title-product">
                        <h2 class="product-title">Single product title</h2>
                    </div>
                    <!-- Product Head End -->


                    <!-- Price Box Start -->
                    <div class="price-box m-b-10" id="price-product">
                        <span class="regular-price">$70.00</span>
                    </div>
                    <!-- Price Box End -->

                    <!-- SKU Start -->
                    <div class="sku m-b-15" id="num-product">
                        <span>库存: 12345</span>
                    </div>
                    <!-- SKU End -->

                    <!-- Product Inventory Start -->
                    <div class="product-inventroy m-b-15" id="sellPoint-product">
                        <span class="inventroy-title"> <strong>商品详情:</strong></span>
                        <span class="inventory-varient">12 Left in Stock</span>
                    </div>
                    <!-- Product Inventory End -->

                    <!-- Description Start -->
                    <p class="desc-content m-b-25">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.</p>
                    <!-- Description End -->

                    <!-- Quantity Start -->
                    <div class="quantity d-flex align-items-center m-b-25">
                        <span class="m-r-10"><strong>数量: </strong></span>
                        <div class="cart-plus-minus">
                            <input id="nums" class="cart-plus-minus-box" value="1" type="text">
                            <div id="btn-reduce-product" class="dec qtybutton">-</div>
                            <div id="btn-add-product" class="inc qtybutton">+</div>
                        </div>
                    </div>
                    <!-- Quantity End -->

                    <!-- Cart Button Start -->
                    <div class="cart-btn action-btn m-b-30">
                        <div class="action-cart-btn-wrapper d-flex">
                            <div class="add-to_cart">
                                <button id="btn-add" class="btn btn-primary btn-hover-dark rounded-0">添加购物车</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Product Summery End -->

            </div>

        </div>
    </div>
</div>
<!-- Single Product Section End -->

<!-- Footer Section Start -->
<footer class="section footer-section">

    <!-- Footer Top Start -->
    <div class="footer-top bg-name-bright section-padding">
        <div class="container">
            <div class="row m-b-n40">
                <div class="col-12 col-sm-6 col-lg-3 m-b-40" data-aos="fade-up" data-aos-duration="1000">
                    <div class="single-footer-widget">
                        <h1 class="widget-title">关于我们</h1>
                        <p class="desc-content">Lorem ipsum dolor sit amet, co adipisi elit, sed eiusmod tempor incididunt ut labore et dolore</p>
                        <!-- Soclial Link Start -->
                        <!-- Social Link End -->
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-3 m-b-40" data-aos="fade-up" data-aos-duration="1200">
                    <div class="single-footer-widget">
                        <h2 class="widget-title">常见问题</h2>
                        <ul class="widget-list">
                            <li>用户反馈</li>
                            <li>诚信举报</li>
                            <li>加入我们</li>
                            <li>资质规则</li>
                        </ul>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-3 m-b-40" data-aos="fade-up" data-aos-duration="1400">
                    <div class="single-footer-widget">
                        <h2 class="widget-title">品牌合作</h2>
                        <ul class="widget-list">
                            <li>开放媒体</li>
                            <li>媒体报道</li>
                            <li>入驻加盟</li>
                            <li>@xiaosu.com</li>
                        </ul>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-3 m-b-40" data-aos="fade-up" data-aos-duration="1600">
                    <div class="single-footer-widget">
                        <h2 class="widget-title">客服-1213-3123</h2>
                        <div class="widget-body">
                            <p class="desc-content m-b-20">感谢购物，祝你天天开心!</p>
                            <p class="desc-content m-b-20">&nbsp;&nbsp;商城为你提供生活便捷，给你的身心带来快乐，感谢你的支持</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer Top End -->
</footer>
<script src="assets/js/vendor.min.js"></script>
<script src="assets/js/plugins.min.js"></script>
<!--Main JS-->
<script src="assets/js/main.js"></script>
<script src="assets/js/jquery-3.3.1.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        const url = location.search; //获取url中"?"符后的字串 ?vm_id=2
        let pid;
        let str;
        let strs;
        if (url.indexOf("?") != -1) {
            str = url.substr(1);
            strs = str.split("=");
            pid = strs[1];
        }
        showProduct(pid);
    })
    function showProduct(pid){
        $('#title-product').empty();
        $('#sellPoint-product').empty();
        $('#price-product').empty();
        $('#num-product').empty();
        $('#top-image').empty();
        $.ajax({
            url:'/products/'+pid+'/product',
            type:'get',
            data:pid,
            dataType:'JSON',
            success:function(json){
                let list=json.data;
                let detailImage='<div class="swiper-slide w-100">'
                                + '<img id="detail-image" class="w-100" src="#{image}1.webp" alt="Product">'
                                + '</div>';
                detailImage = detailImage.replace(/#{image}/g, list.image);
                $('#top-image').html(detailImage)
                let titles='<h2 class="product-title">#{title}</h2>';
                let prices='<span class="regular-price">￥:&nbsp;&nbsp;#{price}</span>';
                let nums='<span>库存&nbsp;:&nbsp;&nbsp; #{num}</span>';
                let sellPoints='<span class="inventroy-title"> <strong>商品详情:&nbsp;&nbsp;</strong></span>'
                    +'<span class="inventory-varient">#{sellPoint}</span>';
                titles = titles.replace(/#{title}/g, list.title);
                sellPoints = sellPoints.replace(/#{sellPoint}/g, list.sellPoint);
                prices = prices.replace(/#{price}/g, list.price);
                nums = nums.replace(/#{num}/g, list.num);
                $('#title-product').html(titles);
                $('#sellPoint-product').html(sellPoints);
                $('#price-product').html(prices);
                $('#num-product').html(nums);

                //点击切换图片
                let sum=1;
                $('#right-image').click(function (){
                    while(true){
                        sum++;
                        var img=document.getElementById("detail-image");
                        img.src=list.image+sum+'.webp';
                        break;
                    }
                    if(sum>3){
                        sum=1;
                    }
                });
                let sum2=1;
                $('#left-image').click(function (){
                    while(true){
                        if(sum2<=1){
                            sum2=3;
                        }else {
                            sum2--;
                        }
                        var img=document.getElementById("detail-image");
                        img.src=list.image+sum2+'.webp';
                        break;
                    }
                })
            },
            error(xhr){
                alert("显示出错");
            }
        })
    }
    //添加购物车
    const url = location.search; //获取url中"?"符后的字串 ?vm_id=2
    let pid;
    let str;
    let strs;
    if (url.indexOf("?") != -1) {
        str = url.substr(1);
        strs = str.split("=");
        pid = strs[1];
    }
    $('#btn-add').click(function(){
        $.ajax({
            url:'/cart/add_to_cart',
            type:'get',
            data: {
                "pid": pid,
                "amount":$('#nums').val()
            },
            dataType: 'JSON',
            success:function(json){
                if (json.state == 200) {
                    alert("增加成功！");
                    location.href="cart.html";
                } else {
                    alert("增加失败！" + json.message);
                }
            },
            error:function (xhr){
                alert("添加失败,请先登录");
                location.href="login.html";
            }
        })
    })

</script>
</body>
</html>